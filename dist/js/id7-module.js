import t from"jquery";import e from"headroom.js";import a from"bootstrap/js/transition";import o from"bootstrap/js/alert";import n from"bootstrap/js/button";import i from"bootstrap/js/carousel";import s from"bootstrap/js/collapse";import r from"bootstrap/js/dropdown";import d from"bootstrap/js/modal";import l from"bootstrap/js/tooltip";import c from"bootstrap/js/popover";import p from"bootstrap/js/scrollspy";import f from"bootstrap/js/tab";import u from"bootstrap/js/affix";import h from"bootstrap-3-typeahead";import m from"jqdoublescroll";import g from"lodash-es/merge";import w from"headroom.js/dist/jQuery.headroom";import v from"lodash-es/find";import b from"lodash-es/defaults";import x from"lodash-es/escape";import A from"loglevel";import k from"lodash-es/defer";import y from"lodash-es/union";import C from"lodash-es/some";var S=M(t),T=M(e);function M(t){return t&&t.__esModule?t:{default:t}}window.jQuery=S.default,(0,S.default)(document).off("keydown.bs.dropdown.data-api",'[data-toggle="dropdown"]',S.default.fn.dropdown.Constructor.prototype.keydown),(0,S.default)(document).off("keydown.bs.dropdown.data-api",".dropdown-menu",S.default.fn.dropdown.Constructor.prototype.keydown);S.default.fn.dropdown.Constructor.prototype.keydown=function(t){if(/input|textarea/i.test(t.target.tagName)||!/(38|40|27|32)/.test(t.which)&&(t.which<65||t.which>90))return;if(t.ctrlKey||t.altKey)return;const e=(0,S.default)(this);if(t.preventDefault(),t.stopPropagation(),e.is(".disabled, :disabled"))return;const a=function(t){var e=t.attr("data-target");e||(e=(e=t.attr("href"))&&/#[A-Za-z]/.test(e)&&e.replace(/.*(?=#[^\s]*$)/,""));var a="#"!==e?(0,S.default)(document).find(e):null;return a&&a.length?a:t.parent()}(e),o=a.hasClass("open");(!o&&27!==t.which||o&&27===t.which)&&(27===t.which&&a.find('[data-toggle="dropdown"]').trigger("focus"),(0,S.default)(".dropdown-backdrop").remove(),(0,S.default)('[data-toggle="dropdown"]').each((function(){var o={relatedTarget:this};a.hasClass("open")&&(a.trigger(t=S.default.Event("hide.bs.dropdown",o)),e.attr("aria-expanded","false"),a.removeClass("open").trigger(S.default.Event("hidden.bs.dropdown",o)))})));const n=a.find(".dropdown-menu li:not(.disabled):visible a");if(!n.length)return;let i=n.index(t.target);if(38===t.which&&(i=(i-1)%n.length),40===t.which&&(i=(i+1)%n.length),t.which>=65&&t.which<=90&&n.length<100){var s=t.key.toLowerCase();let e=n.index(t.target);var r=n.filter((function(){return 0===(0,S.default)(this).text().trim().toLowerCase().indexOf(s)}));r.each((function(){var a=(0,S.default)(this),o=n.index(a);if(o>e||(0,S.default)(t.target).text().trim().toLowerCase().charAt(0)!==s)return i=o,!1})),i===e&&r.length>0&&(i=n.index(r.eq(0)))}n.eq(i).trigger("focus")},(0,S.default)(document).on("keydown.bs.dropdown.data-api",'[data-toggle="dropdown"]',S.default.fn.dropdown.Constructor.prototype.keydown),(0,S.default)(document).on("keydown.bs.dropdown.data-api",".dropdown-menu",S.default.fn.dropdown.Constructor.prototype.keydown);const P=S.default.fn.modal.Constructor.prototype.backdrop;S.default.fn.modal.Constructor.prototype.backdrop=function(t){if(t){const e=()=>{const{$element:e,$backdrop:a}=this,o=e.closest(".id7-fixed-width-container");a&&1===o.length&&a.appendTo(o),t()};P.call(this,e)}else P.call(this,t)},S.default.fn.tooltip.Constructor.DEFAULTS.whiteList.iframe=["src","scrolling","frameborder","allowtransparency","seamless","sandbox"];var _=N(g),D=N(t);function N(t){return t&&t.__esModule?t:{default:t}}D.default.fn.id7Popover=function(t){let e=this;e=e.not(".".concat("id7Popover-init"));const a=D.default.extend({},{template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><button type="button" class="close"><i class="fas fa-times" aria-hidden="true"></i><span class="sr-only">Close</span></button><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>',sanitize:!1},t);function o(t){const e=t.data("creator");e&&(e.popover("hide"),e.tooltip("enable"),e.data("bs.popover").inState.click=!1)}return e.on("click",t=>{const e=(0,D.default)(t.currentTarget);e.tooltip("disable"),e.trigger("mouseout"),e.hasClass("disabled")&&t.stopImmediatePropagation(),t.preventDefault(),t.stopPropagation()}),e.filter((t,e)=>-1===((0,_.default)({},a,{trigger:(0,D.default)(e).data("trigger")}).trigger||"").indexOf("focus")).on("keypress",(function(t){return 13!==t.keyCode||(t.stopPropagation(),t.preventDefault(),(0,D.default)(this).triggerHandler("click"),!1)})),e.on("hidden",t=>{t.stopPropagation()}),e.on("hidden.bs.popover",".use-tooltip",t=>{(0,D.default)(t.currentTarget).tooltip("enable")}),(0,D.default)("html").not(".".concat("id7Popover-dismissHandler")).off("click.popoverDismiss").on("click.popoverDismiss",t=>{const e=(0,D.default)(t.target);0===e.closest(".popover").length&&0===(0,D.default)(t.target).closest(".has-popover").length?(0,D.default)(".popover").each((t,e)=>o((0,D.default)(e))):e.closest(".close").length>0&&o(e.closest(".popover"))}).off("keyup.popoverDismiss").on("keyup.popoverDismiss",t=>{27===(t.which||t.keyCode)&&(0,D.default)(".popover").each((t,e)=>o((0,D.default)(e)))}).addClass("id7Popover-dismissHandler"),e.closest(".fix-on-scroll").on("fixed",()=>{e.each((t,e)=>{const a=(0,D.default)(e);a.popover().data("bs.popover").tip().is(":visible")&&a.popover("show")})}),e.on("shown.bs.popover",t=>{(0,D.default)(t.currentTarget).popover().data("bs.popover").tip().data("creator",(0,D.default)(t.currentTarget))}),e.each((t,e)=>{(0,D.default)(e).popover(D.default.extend({},a,{container:(0,D.default)(e).data("container"),trigger:(0,D.default)(e).data("trigger")})).addClass("id7Popover-init")}),e.each((t,e)=>{(0,D.default)(e).attr("data-title")&&(0,D.default)(e).attr("data-original-title",(0,D.default)(e).attr("data-title"))}),e},window.Headroom=T.default;var L={};Object.defineProperty(L,"__esModule",{value:!0});var E=void 0;L.default=E;const j=window.matchMedia||window.msMatchMedia||(()=>!1);class O{constructor(){this.tests={}}static mq(t){const e=j(t);return e&&e.matches||!1}static cssSupports(t,e){return void 0!==window.CSS&&"supports"in window.CSS?window.CSS.supports(t,e):"supportsCSS"in window?window.supportsCSS("".concat(t,":").concat(e)):"display"===t&&"flex"===e&&/rv:11.0/i.test(window.navigator.userAgent)}static toggleClasses(t,e,a){a?t.removeClass("no-".concat(e)).addClass(e):t.removeClass(e).addClass("no-".concat(e))}addTest(t,e){this.tests[t]=e,O.prototype[t]=e,this.$container&&O.toggleClasses(this.$container,t,e)}addClasses(t){this.$container=t,Object.keys(this.tests).forEach(e=>{O.toggleClasses(t,e,this.tests[e])})}}E=O,L.default=E;var H=B(t),R=B(L);function B(t){return t&&t.__esModule?t:{default:t}}const I=new R.default;I.addTest("js",!0),I.addTest("flexbox",R.default.cssSupports("display","flex"));let Q=!1;try{Q="SVGFEColorMatrixElement"in window&&2===SVGFEColorMatrixElement.SVG_FECOLORMATRIX_TYPE_SATURATE}catch(t){}I.addTest("svgfilters",Q);const U={webp:"data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoBAAEAAwA0JaQAA3AA/vuUAAA=","webp-alpha":"data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAABBxAR/Q9ERP8DAABWUDggGAAAADABAJ0BKgEAAQADADQlpAADcAD++/1QAA==","webp-animation":"data:image/webp;base64,UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA","webp-lossless":"data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="};function W(t,e){const a=new Image;function o(o){const n=!(!o||"load"!==o.type)&&1===a.width;I.addTest(t,n),e&&e(o)}a.onerror=o,a.onload=o,a.src=U[t]}W("webp",t=>{t&&"load"===t.type&&(W("webp-alpha"),W("webp-animation"),W("webp-lossless"))});const{userAgent:$}=window.navigator;I.addTest("safari",$.indexOf("Safari/")>=0&&-1===$.indexOf("Chrome/")),I.addTest("ie-or-edge",/MSIE (?:9|7|10)/i.test($)||/rv:11.0/i.test($)||/Edge\/\d./i.test($)),I.addTest("embedded-ie",/MSIE 7/i.test($)&&/\.NET/.test($)),I.addClasses((0,H.default)(document.documentElement)),window.Modernizr=I;var F={};Object.defineProperty(F,"__esModule",{value:!0});var z=function(){return(0,J.default)(K,t=>t.matcher().matches)};F.default=z;var G=function(){return K};F.allScreenSizes=G;var q,J=(q=v)&&q.__esModule?q:{default:q};const K=[{name:"lg",matcher:()=>window.matchMedia("(min-width: 1200px)"),container:1170},{name:"md",matcher:()=>window.matchMedia("(min-width: 992px) and (max-width: 1199px)"),container:970},{name:"sm",matcher:()=>window.matchMedia("(min-width: 768px) and (max-width: 991px)"),container:750},{name:"xs",matcher:()=>window.matchMedia("(max-width: 767px)")}];var V=function(t){return t&&t.__esModule?t:{default:t}}(t),X=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=Y();if(e&&e.has(t))return e.get(t);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=o?Object.getOwnPropertyDescriptor(t,n):null;i&&(i.get||i.set)?Object.defineProperty(a,n,i):a[n]=t[n]}a.default=t,e&&e.set(t,a);return a}(F);function Y(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return Y=function(){return t},t}const Z={eventName:"id7:reflow"};class tt{constructor(t){this.options=V.default.extend({},Z,t),this.onScreenResize(),this.wireEventHandlers()}onScreenResize(){const t=(0,X.default)();this.options.container.trigger(this.options.eventName,[t])}reflow(){"xs"===(0,X.default)().name?(0,V.default)(window).on("resize.id7.reflow.onScreenResize",V.default.proxy(this.onScreenResize,this)):(0,V.default)(window).off("resize.id7.reflow.onScreenResize"),this.onScreenResize()}wireEventHandlers(){(0,X.allScreenSizes)().forEach(t=>{const{matcher:e,name:a}=t;e().addListener(e=>{e.matches&&(this.options.container.trigger(this.options.eventName,[t]),"xs"===a?(0,V.default)(window).on("resize.id7.reflow.onScreenResize",V.default.proxy(this.onScreenResize,this)):(0,V.default)(window).off("resize.id7.reflow.onScreenResize"))})}),"complete"===document.readyState?this.reflow():(0,V.default)(window).on("load",V.default.proxy(this.reflow,this))}}V.default.fn.reflow=function(t){return this.each((function(e,a){const o=(0,V.default)(a);let n=o.data("id7.reflow");const i=V.default.extend({},o.data(),{container:o},"object"==typeof t&&t);n||o.data("id7.reflow",n=new tt(i)),"reflow"!==t&&"force"!==t&&!0!==t||n.reflow()}))},(0,V.default)(()=>(0,V.default)(window).reflow());var et=st(b),at=st(x),ot=st(t),nt=st(A),it=st(F);function st(t){return t&&t.__esModule?t:{default:t}}const rt={Templates:{Popover:t=>'<div class="account-info">\n        <iframe src="'.concat((0,at.default)(t.useMwIframe?"".concat(t.iframelink,"?embedded"):t.legacyIframeLink),'" \n                scrolling="auto" frameborder="0" allowtransparency="true" \n                seamless \n                sandbox="allow-same-origin allow-scripts allow-top-navigation allow-forms allow-popups"></iframe>\n        </div>\n        <div class="actions">\n          <div class="btn-group btn-group-justified">\n            <div class="btn-group sign-out">\n              <a href="').concat((0,at.default)(t.logoutlink),'" class="btn btn-default">Sign out</a>\n            </div>\n          </div>\n        </div>'),Action:t=>'<div class="btn-group">\n        <a href="'.concat((0,at.default)(t.href),'" \n           title="').concat((0,at.default)(t.tooltip),'" \n           class="btn btn-default ').concat((0,at.default)(t.classes),'">').concat((0,at.default)(t.title),"</a>\n        </div>")},Defaults:{container:!1,iframelink:"https://my.warwick.ac.uk/",notificationsApi:"https://my.warwick.ac.uk/api/id7/notifications/unreads",legacyIframeLink:"https://websignon.warwick.ac.uk/origin/account/popover",showNotificationsBadge:!0,useMwIframe:!0,maxNumberNotifications:99,template:'\n      <div class="popover my-warwick hybrid-overlay">\n        <div class="arrow"></div>\n        <div class="popover-inner">\n            <div class="popover-content"><p></p></div>\n        </div>\n      </div>'.trim()},MessagePrefix:"message.id7.account-popover."};class dt{constructor(t){const e=ot.default.extend({},rt.Defaults,t);this.$trigger=e.trigger,this.options=e,void 0===this.options.logoutlink&&(this.options.logoutlink=this.$trigger.attr("href")),this.wireEventHandlers()}createPopover(t){const e={container:this.options.container,content:rt.Templates.Popover(this.options),template:this.options.template,html:!0,placement:"bottom",title:"Account information",trigger:"manual"};t.popover(e)}static isBlacklistedDevice(){const{userAgent:t}=navigator;return-1!==t.indexOf("iPad")}static isMwFeatureAvailable(){return!dt.isBlacklistedDevice()}wireEventHandlers(){const{$trigger:t}=this,e=this,a=this.options.iframelink;if(this.options.name){let e='<span class="fa-stack id7-notifications-badge">\n        <i class="fa fa-circle fa-stack-2x"></i>\n        <strong class="fa-stack-1x fa fa-spinner fa-spin brand-text counter-value"></strong>\n      </span>';dt.isMwFeatureAvailable()&&this.options.showNotificationsBadge||(e=""),t.html("".concat(this.options.name).concat(e,'<span class="caret"></span>'))}const o=t.find(".id7-notifications-badge");var n,i,s;t.on("click",n=>(n.preventDefault(),n.stopPropagation(),t.popover("toggle"),o.find(".counter-value:not(.fa-exclamation-triangle):not(.fa-spinner)").text("0"),e.options.iframelink=a,t.data("bs.popover").options.content=rt.Templates.Popover(e.options),o.removeClass("animating"),t.blur(),!1)),this.createPopover(t),this.options.showNotificationsBadge&&dt.isMwFeatureAvailable()&&(n=this.options.notificationsApi,i=n=>{const i=Math.min(n.unreads,99);o.find(".counter-value").removeClass("fa-spinner").removeClass("fa-spin").addClass("slideInDown").text(i),i>0&&(o.fadeIn().addClass("animating"),e.options.iframelink="".concat(a,"alerts"),t.data("bs.popover").options.content=rt.Templates.Popover(e.options))},s=()=>{o.find(".counter-value").removeClass("fa-spinner").removeClass("fa-spin").addClass("fa-exclamation-triangle"),o.attr("title","There was a problem communicating with the MyWarwick notifications service")},ot.default.ajax({url:n,success:i,error:s,dataType:"json",xhrFields:{withCredentials:!0}})),(0,ot.default)("html").on("click.popoverDismiss",e=>{const a=(0,ot.default)(e.target);0===a.closest(".popover").length&&0===a.closest(".use-popover").length&&0===a.closest(t).length&&(t.popover("hide"),t.data("bs.popover").inState.click=!1)});const r=ot.default.proxy((e,a)=>{if(this.options.useMwIframe=this.options.useMwIframe&&"xs"!==a.name&&(0,ot.default)(window).height()>=512&&dt.isMwFeatureAvailable(),t.find(".id7-notifications-badge").toggle(this.options.useMwIframe),void 0!==t.data("bs.popover")){t.data("bs.popover").options.content=rt.Templates.Popover(this.options);const e=this.options.useMwIframe&&dt.isMwFeatureAvailable()?"my-warwick":"account-information",a=t.data("bs.popover");a.tip().removeClass("account-information","my-warwick").addClass(e),a.tip().hasClass("in")&&(t.popover("show"),t.next(".popover").removeClass("loading"))}},this);(0,ot.default)(window).on("id7:reflow",r),"complete"===document.readyState&&void 0!==(0,ot.default)(window).data("id7.reflow")&&r({},(0,it.default)())}onMessage(t,e){const a=this.$trigger.next(".popover");switch(t){case"addAction":(0,et.default)(e,{classes:"",tooltip:""}),a.find(".actions > .btn-group").prepend(rt.Templates.Action(e)),a.find(".actions > .btn-group > .btn-group").first().find('[title]:not([title=""])').tooltip({placement:"bottom"});break;case"resizeIframe":a.find(".account-info iframe").height(e.height);break;case"layoutDidMount":a.addClass("loaded"),this.updateColourTheme(e.colourTheme);break;case"colourThemeChange":this.updateColourTheme(e.colourTheme);break;case"signedOut":{const{loginlink:t}=this.options;a.find(".actions > .btn-group > .sign-out").replaceWith(rt.Templates.Action({href:t,classes:"sign-in",title:"Sign in",tooltip:""}));break}default:nt.default.error("Unexpected message type: ".concat(t))}}updateColourTheme(t){this.$trigger.next(".popover").removeClass((t,e)=>ot.default.grep(e.split(" "),t=>0===t.indexOf("theme-")).join(" ")).addClass("theme-".concat(t))}}ot.default.fn.accountPopover=function(t){const e=t||{};return this.each((function(t,a){const o=(0,ot.default)(a),n=new dt(ot.default.extend({},o.data(),e,{trigger:o}));o.data("id7.account-popover",n)}))},(0,ot.default)(()=>{(0,ot.default)('[data-toggle="id7:account-popover"]').accountPopover(),(0,ot.default)(window).on("message",t=>{const{origin:e}=t.originalEvent;try{const a=JSON.parse(t.originalEvent.data);if(a.type&&0===a.type.indexOf(rt.MessagePrefix)){const t=a.type.substring(rt.MessagePrefix.length);(0,ot.default)('[data-toggle="id7:account-popover"]').each((function(){const o=(0,ot.default)(this).data("id7.account-popover");0!==o.options.iframelink.indexOf(e)&&0!==o.options.legacyIframeLink.indexOf(e)?nt.default.error("Ignored message of type ".concat(t," because origin ").concat(e," didn't match iframe link ").concat(o.options.iframelink)):o.onMessage(t,a)}))}}catch(t){}})});var lt={};Object.defineProperty(lt,"__esModule",{value:!0});var ct=function(t){"replaceState"in window.history?t?window.history.replaceState({},null,t):window.history.replaceState({},null,window.location.pathname+window.location.search):window.location.hash=t};lt.default=ct;var pt=vt(k),ft=vt(y),ut=vt(C),ht=vt(t),mt=vt(e),gt=vt(F),wt=vt(lt);function vt(t){return t&&t.__esModule?t:{default:t}}const bt={Templates:{moreContainer:'<ul class="nav navbar-nav navbar-right">\n        <li class="dropdown">\n          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fas fa-caret-down"></i></a>\n          <ul class="dropdown-menu" role="menu"></ul>\n        </li>\n      </ul>'.trim(),marker:'<div class="id7-navigation-marker"></div>'},Defaults:{fixedHeader:mt.default.cutsTheMustard,fixedNav:mt.default.cutsTheMustard,fitToWidth:!1,collapseSmallscreen:!1,keyboard:!0,trimLinkTitles:{maxLength:60,append:"&hellip;"}},HeadroomEvents:{onPin(){(0,ht.default)(this.elem).trigger("id7:headroom:onPin")},onUnpin(){(0,ht.default)(this.elem).trigger("id7:headroom:onUnpin")}}};class xt{constructor(t){const e=ht.default.extend({},bt.Defaults,t);this.$container=e.container,e.trimLinkTitles&&"object"!=typeof e.trimLinkTitles&&(e.trimLinkTitles=ht.default.extend({},bt.Defaults.trimLinkTitles)),this.options=e,this.options.fixedHeader&&xt.markHeaderFixedPosition(),this.options.fixedNav&&this.markFixedPosition(),e.trimLinkTitles&&this.trimLinkTitles(),this.wireEventHandlers()}trimLinkTitles(){const{maxLength:t,append:e}=this.options.trimLinkTitles;this.$container.find(".nav a").filter((function(){return ht.default.trim((0,ht.default)(this).text()).length>t})).each((function(){const a=(0,ht.default)(this),o=ht.default.trim(a.text()),n=o.split(/\s+/g),i=[];ht.default.each(n,(e,a)=>{const o=i.join(" ");return!("".concat(o," ").concat(a).length>t)&&(i.push(a),!0)}),a.attr("title",o).text(i.join(" ")).append(e)}))}static affixHeader(){const t=(0,ht.default)(".id7-header-text h1");if(t.length){xt.markHeaderFixedPosition();const e=(0,ht.default)(".id7-header-text").offset().top;let a=e;const o=(0,ht.default)(".id7-main-content-area");o.length>0&&(a=o.offset().top);const n=ht.default.extend(bt.HeadroomEvents,{offset:a});t.affix({offset:{top:e}}).headroom(n)}}affixNav(){const t=this.$container,e=(0,ht.default)(".id7-header-text h1");let a;a=e.length?e.offset().top:t.offset().top;let o=a;(0,ht.default)(".id7-main-content-area").length>0&&(o=(0,ht.default)(".id7-main-content-area").offset().top);const n=ht.default.extend(bt.HeadroomEvents,{offset:o});t.affix({offset:{top:a}}).headroom(n)}fitToWidth(t){const{options:e}=this;this.$container.find(".navbar:not(.navbar-secondary)").each((function(){const a=(0,ht.default)(this),o=a.find("> .nav").first();let n=a.find("> .navbar-right");if(n.find("> .dropdown > .dropdown-menu > li").each((function(){const t=(0,ht.default)(this);o.append(t)})),0===n.length&&(n=(0,ht.default)(bt.Templates.moreContainer),a.append(n)),n.addClass("hidden"),!e.collapseSmallscreen||"xs"!==t.name){const t=()=>(0,ut.default)((0,ft.default)(o.find("> li").get(),n.get()),t=>(0,ht.default)(t).is(":visible")&&(0,ht.default)(t).position().top>0);if(t()){n.removeClass("hidden");do{n.find("> .dropdown > .dropdown-menu").prepend(o.find("> li:not(.nav-breadcrumb)").last().css("height",""))}while(t()&&o.find("> li:not(.nav-breadcrumb)").length>0);const e=n.find("> .dropdown");e.toggleClass("active",e.find("li.active").length>0)}}}))}updateWrappedState(){this.$container.find(".navbar").each((function(){const t=(0,ht.default)(this),e=t.hasClass("navbar-wrapped"),a=t.find("> .nav > li:last"),o=a.length&&a.position().top>0;o!==e&&(t.addClass("important-no-transition"),t.toggleClass("navbar-wrapped",o),(0,pt.default)(()=>t.removeClass("important-no-transition")))}))}updateDropdownBehaviour(t){this.$container.find(".navbar").each((function(){const e=(0,ht.default)(this);"xs"===t.name?e.find(".dropdown-toggle").attr("data-toggle","dropdown").attr("role","button").attr("aria-expanded",!1):e.find(".dropdown-toggle").removeAttr("data-toggle").removeAttr("role").removeAttr("aria-expanded").parent().removeClass("open")}))}getAffixedHeight(){let t=0;return this.options.fixedHeader&&(t+=(0,ht.default)(".id7-header-text h1").outerHeight()),this.options.fixedNav&&(t+=this.$container.outerHeight()),t}hashChanged(){const t=this.getAffixedHeight();setTimeout(()=>window.scrollBy(0,-t),1)}static markHeaderFixedPosition(){const t=(0,ht.default)(".id7-header-text");t.css("height","");const e=(0,ht.default)(".id7-header-text h1"),a=e.hasClass("affix");a&&e.removeClass("affix"),t.height(t.height()),a&&e.addClass("affix")}markFixedPosition(){let t=this.$container.next(".id7-navigation-marker");0===t.length&&(t=(0,ht.default)(bt.Templates.marker),this.$container.after(t)),t.height(this.$container.height())}wireEventHandlers(){"complete"===document.readyState?(this.options.fixedNav&&this.affixNav(),this.options.fixedHeader&&xt.affixHeader(),this.updateWrappedState()):(0,ht.default)(window).on("load",ht.default.proxy((function(){this.options.fixedNav&&this.affixNav(),this.options.fixedHeader&&xt.affixHeader(),this.updateWrappedState()}),this));const t=ht.default.proxy((function(t,e){this.options.fitToWidth&&this.fitToWidth(e),this.options.fixedHeader&&xt.markHeaderFixedPosition(),this.options.fixedNav&&this.markFixedPosition(),this.updateWrappedState(),this.updateDropdownBehaviour(e)}),this);(0,ht.default)(window).on("id7:reflow",t),"complete"===document.readyState&&void 0!==(0,ht.default)(window).data("id7.reflow")&&t({},(0,gt.default)()),this.$container.on("click",".nav > li",(function(t){let e=(0,ht.default)(t.target).closest("a");if(!(e.length>0))return e=(0,ht.default)(this).find("a").first(),e.length>0?(t.stopPropagation(),t.preventDefault(),e[0].click(),!1):void 0})),document.location.hash&&this.hashChanged(),(0,ht.default)(window).on("hashchange",ht.default.proxy(this.hashChanged,this)),this.options.keyboard&&(this.$container.on("keydown",t=>{const e=(0,ht.default)(document.activeElement),a=e.parent(),o="ArrowDown"===t.key,n="ArrowUp"===t.key,i=a.find(".dropdown-menu").parent().hasClass("open");if(a.hasClass("dropdown")&&(o&&!i||n&&i)){return a.find("> a").dropdown("toggle"),t.preventDefault(),(i?a.find("> a"):a.find(".dropdown-menu").find("li:first-child a")).focus(),!1}const s=a.parent().hasClass("navbar-nav"),r=a.parent().hasClass("dropdown-menu"),d="ArrowRight"===t.key;if(d&&s)a.next().length>0&&a.next().children().length>0?a.next().children().first().focus():xt.tryNextNav(e);else if(d&&r){const t=a.parents().eq(1).next();return xt.openOrFocusNav(a,t),!1}const l="ArrowLeft"===t.key;if(l&&s)a.prev().length>0&&a.prev().children().length>0?a.prev().children().first().focus():xt.tryPrevNav(e);else if(l&&r){const t=a.parents().eq(1).prev();return xt.openOrFocusNav(a,t),!1}return!0}),(0,ht.default)(".dropdown-menu",this.$container).each((t,e)=>{const a=(0,ht.default)(e),o=a.parent().find("> a");o.length>0&&"dropdown"!==o.attr("data-toggle")&&(o.attr("data-toggle","dropdown"),o.dropdown()),o.length>0&&"true"!==o.attr("aria-haspopup")&&o.attr("aria-haspopup","true"),a.parent().find("> ul > li").attr("role","menuitem"),o.on("click keypress",t=>{"click"!==t.type&&"Enter"!==t.key||(void 0!==o.attr("href")&&(window.location=o.attr("href")),t.stopPropagation())})}))}static openOrFocusNav(t,e){0!==e.length&&(t.parents().eq(1).find("> a").dropdown("toggle"),e.hasClass("dropdown")?(e.find("> a").dropdown("toggle"),e.find("> ul > li:first-child > a").focus()):e.find("> a").focus())}static tryNextNav(t){xt.tryNextPrevNav(t.parents(".navbar"),!0)}static tryPrevNav(t){xt.tryNextPrevNav(t.parents(".navbar"),!1)}static tryNextPrevNav(t,e){const a=e?t.next(".navbar"):t.prev(".navbar"),o=a.find("a:visible");if(a.length>0&&o.length>0){(e?o.first():o.last()).focus()}if(a.length>0)return this.tryNextPrevNav(a.first(),e)}}ht.default.fn.id7Navigation=function(t){const e=t||{};return this.each((function(t,a){const o=(0,ht.default)(a),n=new xt(ht.default.extend({},o.data(),e,{container:o}));o.data("id7.navigation",n)}))},(0,ht.default)(()=>{(0,ht.default)(".id7-navigation").id7Navigation(),document.body.hasAttribute("id")||document.body.setAttribute("id","top");const t=(0,ht.default)('.sr-only.sr-only-focusable[href="#main"]'),e=(0,ht.default)(".id7-navigation").first(),a=1===t.length,o=1===e.length,n=0===(0,ht.default)('.sr-only.sr-only-focusable[href="#'.concat("primary-nav",'"]')).length;if(o&&void 0===e.attr("id")&&e.attr("id","primary-nav"),n&&a&&o){const a=(0,ht.default)("<a>").addClass("sr-only").addClass("sr-only-focusable").attr("href","#".concat(e.attr("id"))).text("Skip to navigation");t.after(a)}const i=document.location.toString();if(i.match("#")&&i.split("#")[1].length){const t=(0,ht.default)('.nav-tabs a[href="#'.concat(i.split("#")[1],'"]'));t&&t.tab("show")}(0,ht.default)(".nav-tabs a").on("shown.bs.tab.id7Navigation",t=>(0,wt.default)(t.target.hash))});var At=Ct(x),kt=Ct(t),yt=Ct(L);function Ct(t){return t&&t.__esModule?t:{default:t}}kt.default.fn.searchSuggest=function(t){const e=t||{};return this.each((function(t,a){const o=(0,kt.default)(a);!function(t){const e=t||{},a=e.input;a.attr("autocomplete","off").typeahead({minLength:e.minLength,source:e.source,displayText:e.displayText,appendTo:void 0!==e.appendTo?(0,kt.default)(e.appendTo):void 0,fitToElement:e.fitToElement,matcher:()=>!0,highlighter:t=>t,changeInputOnSelect:!1,changeInputOnMove:!1,followLinkOnSelect:!0,openLinkInNewTab:!1,selectOnBlur:!1,showHintOnFocus:!0,itemLink:e.itemLink,afterSelect:()=>a.trigger("blur")}).on("keydown",t=>{switch(t.which||t.keyCode){case 38:case 40:t.altKey||t.ctrlKey||t.metaKey||t.shiftKey||t.stopPropagation()}})}(kt.default.extend({},o.data(),e,{input:o}))}))},kt.default.fn.goSearchSuggest=function(t={}){return this.each((function(e,a){(0,kt.default)(a).next(".fa,.fas,.fal,.fab,.far").on("click",t=>{t.preventDefault(),t.stopPropagation(),(0,kt.default)(a).closest("form").submit()});let o=3,n=3;yt.default.mq("only all and (min-width: 768px)")&&(o=2,n=6);const i=(0,kt.default)(a);i.searchSuggest(kt.default.extend(t,i.data(),{source:(t,e)=>{kt.default.getJSON("https://sitebuilder.warwick.ac.uk/sitebuilder2/api/go/redirects.json?maxResults=".concat(n,"&prefix=").concat(encodeURIComponent(t)),e)},minLength:o,display:t=>t.path,displayText:t=>'<div><p class="go-path">'.concat((0,At.default)(t.path),'</p><p class="go-description">').concat(void 0!==t.description?(0,At.default)(t.description):"","</p></div>"),itemLink:t=>"https://go.warwick.ac.uk/".concat(t.path,"?goSearchReferer=").concat(encodeURIComponent(window.location),"&goSearchQuery=").concat(encodeURIComponent((0,kt.default)(a).val()))})),i.width()<88&&i.attr("placeholder","Search")}))},(0,kt.default)(()=>(0,kt.default)('input[data-suggest="go"]').goSearchSuggest());var St=Mt(t),Tt=Mt(L);function Mt(t){return t&&t.__esModule?t:{default:t}}const Pt={Templates:{PopoutLink:'<span class="id7-table-wrapper-popout">(<a href="#" data-toggle="id7:popout-table">Pop-out table</a>)</span>',Modal:'\n      <div class="id7-wide-table-popout-modal modal fade" tabindex="-1" role="dialog" aria-hidden="true">\n        <div class="modal-dialog">\n          <div class="modal-content">\n            <div class="modal-header">\n              <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                <span aria-hidden="true">&times;</span>\n              </button>\n              <span class="modal-title">&nbsp;</span>\n            </div>\n            <div class="modal-body">\n            </div>\n          </div>\n        </div>\n      </div>'.trim()},Defaults:{container:"id7-wide-table-wrapper-container",wrapper:"table-responsive",popout:()=>Tt.default.mq("only all and (min-width: 768px)"),doublescroll:!0}};class _t{constructor(t){const e=St.default.extend({},Pt.Defaults,t);_t.findWideTables(e.container).each((function(t,a){const o=(0,St.default)(a),n=St.default.extend({},e,o.data());if(n.wrapper&&"string"!=typeof n.wrapper&&(n.wrapper=Pt.Defaults.wrapper),n.container&&"string"!=typeof n.container&&(n.container=Pt.Defaults.container),n.wrapper){_t.wrap(o,n.wrapper,n.container);const t=o.parent(),e=t.parent();let{popout:a}=n;const{doublescroll:i}=n;"function"==typeof n.popout&&(a=n.popout()),"function"==typeof n.doublescroll&&(a=n.doublescroll()),a&&_t.popout(o,t,e),i&&_t.doubleScroll(o,t)}}))}static findWideTables(t){return t.find("table").filter((function(){return 0===(0,St.default)(this).parents(".no-wide-tables").length})).filter((function(){const t=(0,St.default)(this),e=t.css("max-width");t.css("max-width","none");const a=!t.data("id7.wide-tables.wrapped")&&Math.floor(t.width())>t.parent().width();return t.css("max-width",e),a}))}static wrap(t,e,a){return t.wrap((0,St.default)("<div />").addClass(a).append((0,St.default)("<div />").addClass(e))).data("id7.wide-tables.wrapped",!0),t.parent()}static popout(t,e,a){if(t.is(":visible")&&!t.hasClass("sb-no-wrapper-table-popout")){a.prepend(Pt.Templates.PopoutLink).append(Pt.Templates.PopoutLink);const t=(0,St.default)(St.default.parseHTML(Pt.Templates.Modal)).appendTo(document.body);a.on("click",'[data-toggle="id7:popout-table"]',a=>(a.stopPropagation(),a.preventDefault(),t.find(".modal-body").html(e.html()),t.modal().modal("show"),!1))}return t}static doubleScroll(t,e){return e.doubleScroll(),t}}St.default.fn.wideTables=function(t){const e=t||{};return this.each((function(t,a){const o=(0,St.default)(a),n=new _t(St.default.extend({},o.data(),e,{container:o}));o.data("id7.wide-tables",n)}))},(0,St.default)(window).on("load id7:ready",()=>(0,St.default)(".id7-main-content").wideTables()),(0,St.default)(()=>(0,St.default)(window).trigger("id7:ready"));var Dt=Lt(t),Nt=Lt('<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg xmlns="http://www.w3.org/2000/svg"\n     xmlns:xlink="http://www.w3.org/1999/xlink" x="0" y="0" version="1.1"\n     focusable="false"\n     class="id7-koan-spinner"\n     viewBox="0 0 112 128">\n\n    <defs>\n        <radialGradient id="koan-background-gradient" cx="1.93" cy="0.5" r="3">\n            <stop offset="0%" stop-color="#e6e6e6" />\n            <stop offset="50%" stop-color="#e6e6e6" />\n            <stop offset="50%" stop-color="#cfcfcf" />\n            <stop offset="100%" stop-color="#cfcfcf" />\n        </radialGradient>\n\n        <path id="body"\n              d="M 48 5\n                 L 16 120\n                 Q 64 128, 96 120\n                 L 64 5\n                 Q 56 0, 48 5"\n              stroke="none" />\n\n        <clipPath id="koan-clip">\n            \x3c!--\n              Everything outside the path will be\n              clipped and therefore invisible.\n            --\x3e\n            <use xlink:href="#body" />\n        </clipPath>\n\n        <path id="bottom"\n              d="M 16 112\n                 Q 64 120, 96 112\n                 L 96 120\n                 Q 64 128, 16 120\n                 L 16 112" />\n\n        <path id="middle"\n              d="M 0 72\n                 Q 64 60, 112 72"\n              fill="none" />\n    </defs>\n\n    <use class="id7-koan-spinner__body" clip-path="url(#koan-clip)" xlink:href="#body" fill="url(#koan-background-gradient)" />\n    <use class="id7-koan-spinner__bottom" clip-path="url(#koan-clip)" xlink:href="#bottom" fill="#808080" />\n    <use class="id7-koan-spinner__middle" clip-path="url(#koan-clip)" xlink:href="#middle" stroke="#cfcfcf" stroke-width="2" />\n\n    <g clip-path="url(#koan-clip)">\n        <g transform="rotate(5)">\n            <path class="id7-koan-spinner__neon id7-koan-spinner__neon--top"\n                  d="M -20 27.5\n                     C 0 10, 10 10, 30 15\n                     C 50 20, 60 20, 80 15\n                     C 100 10, 110 10, 130 15\n                     C 150 20, 160 20, 180 15"\n                  fill="none"\n                  stroke="#14b3b3"\n                  stroke-width="1.5" />\n\n            <path class="id7-koan-spinner__neon id7-koan-spinner__neon--middle"\n                  d="M -20 37.5\n                     C 0 20, 30 20, 90 25\n                     C 150 30, 180 30, 240 25\n                     C 300 20, 330 20, 390 25\n                     C 450 30, 480 30, 540 25"\n                  fill="none"\n                  stroke="#14b3b3"\n                  stroke-width="1.5" />\n\n            <path class="id7-koan-spinner__neon id7-koan-spinner__neon--bottom"\n                  d="M -20 47.5\n                     C 0 30, 10 30, 30 35\n                     C 50 40, 60 40, 80 35\n                     C 100 30, 110 30, 130 35\n                     C 150 40, 160 40, 180 35"\n                  fill="none"\n                  stroke="#14b3b3"\n                  stroke-width="1.5" />\n        </g>\n    </g>\n</svg>\n');function Lt(t){return t&&t.__esModule?t:{default:t}}const Et={target:"i.id7-koan-spinner"},jt=(()=>{let t=0;return e=>"".concat(e).concat(t++)})();class Ot{constructor(t){if(this.options=Dt.default.extend({},Et,t),this.replaceWithSvg(),"undefined"!=typeof MutationObserver&&this.options.container.length){const t=new MutationObserver(t=>{Dt.default.each(t,(t,e)=>{"childList"===e.type&&e.addedNodes.length>0&&this.replaceWithSvg(e.target)})});this.options.container.each((e,a)=>t.observe(a,{childList:!0,subtree:!0}))}else(0,Dt.default)(()=>this.replaceWithSvg())}replaceWithSvg(t){(0,Dt.default)(t||this.options.container).find(this.options.target).each((t,e)=>{const a=(0,Dt.default)(e).prop("attributes"),o=(0,Dt.default)(Nt.default);Dt.default.each(a,(function(){o.attr(this.name,this.value)})),o.find("[id]").each((t,e)=>{const a=(0,Dt.default)(e).attr("id"),n=jt(a);(0,Dt.default)(e).attr("id",n),o.find('use,[clip-path^="url(#"],[fill^="url(#"]').each((t,e)=>{const o=(0,Dt.default)(e).prop("attributes");Dt.default.each(o,(t,o)=>{o.value==="#".concat(a)?(0,Dt.default)(e).attr(o.name,"#".concat(n)):o.value==="url(#".concat(a,")")&&(0,Dt.default)(e).attr(o.name,"url(#".concat(n,")"))})})}),(0,Dt.default)(e).replaceWith(o)})}}Dt.default.fn.id7KoanSpinner=function(t){const e=t||{};return this.each((function(t,a){const o=(0,Dt.default)(a),n=new Ot(Dt.default.extend({},o.data(),e,{container:o}));o.data("id7.koan-spinner",n)}))},(0,Dt.default)(document).id7KoanSpinner();